<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
  </head>
  <body>
    <h1><%= title %></h1>
      <table>
          <tr>
          <td class="title">Web url</td>
          <td><input class="inputWeb" type="text" name="url_name" id="url_name_id" value="" required ></td>
          </tr>
          <tr>
          <td colspan="3"><input class="submitBtn" id="submitBtnId" onclick="startCrawler()" type="submit" value="Save" ></td>
          </tr>
      </table>
      <h2>JSON Rendered as a Output</h2>
      <div id="responseSection"></div>
  </body>
  <script type="text/javascript">
    function startCrawler(){
      const val = document.getElementById('url_name_id').value
      console.log(val)
      if(val && val.includes('http')){
        console.log('enter')
        fetch('/crawling',{
          method: 'POST',
          body: JSON.stringify({link: val}),
          headers: {
          'Accept': 'application/json',
          'Content-Type': 'application/json'
        }
        }).then(resp => resp.json()).then((response) => {
          const { data } = response;
          if(data && data.length > 0){
            document.getElementById('responseSection').innerText =  JSON.stringify(data, null, 4);
          }else {
            document.getElementById('responseSection').innerText = 'No Data!!'
          }
        }).catch((err) => {
          console.log(err);
          document.getElementById('responseSection').innerText = 'No Data!!';
        })
      }
    }
  </script>
</html>
